<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>API for HTTP Access to the Cantus Database &mdash; Cantus API 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Cantus API 0.1.0 documentation" href="#" />
    <link rel="next" title="Resource Types" href="resource_types.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
        <div class="headertitle"><a
          href="#">Cantus API 0.1.0 documentation</a></div>
        <div class="rel">
          <a href="resource_types.html" title="Resource Types"
             accesskey="N">next</a> |
          <a href="http-routingtable.html" title="HTTP Routing Table"
             >routing table</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="api-for-http-access-to-the-cantus-database">
<h1>API for HTTP Access to the Cantus Database<a class="headerlink" href="#api-for-http-access-to-the-cantus-database" title="Permalink to this headline">¶</a></h1>
<p>This is the Application Programming Interface for Cantus database-access projects. The 1.x versions
will only allow searching and reading the database, though (pending funding) 2.x versions will add
the ability to create and edit resources.</p>
<p>To navigate the specification, use the brief Table of Contents to the right, or the <a class="reference internal" href="#detailed-table-of-contents">Detailed Table
of Contents</a> below.</p>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>The API&#8217;s basic design works thusly:</p>
<ul class="simple">
<li>a resource&#8217;s URL &#8220;pathname&#8221; identifies a resource uniquely</li>
<li>the HTTP method indicates the type action to perform; you may wish to <a class="reference internal" href="http_methods.html#get-http-method"><em>GET</em></a> a
resource or receive a list of the available <a class="reference internal" href="http_methods.html#options-http-method"><em>OPTIONS</em></a> for a resource. The
exception, which is only temporary, is that searching uses special GET requests described in
<a class="reference internal" href="searching.html#searching"><em>How to Search</em></a>.</li>
<li>the HTTP headers indicate a desired data format (in requests) and actual format plus metadata (in
responses).</li>
<li>when present, request and response bodies are normally in JSON, although the default will later
change to XML.</li>
</ul>
<div class="section" id="a-note-about-urls">
<h3>A Note about URLs<a class="headerlink" href="#a-note-about-urls" title="Permalink to this headline">¶</a></h3>
<p>Throughout this document, URLs are usually indicated in a generic format, to emphasize their
lack of importance in the API&#8217;s operation. For this reason, domain names are usually omitted so
that URLs begin with <tt class="docutils literal"><span class="pre">/</span></tt>. In addition, most URLs contain parenthesized parts, as in
<tt class="docutils literal"><span class="pre">/(browse_chants)/</span></tt>, to indicate that server implmentations may change actual URLs arbitrarily,
so clients must determine a resource&#8217;s URL dynamically at runtime.</p>
<p>Servers MUST provide clients with relevant URLs in known locations as indicated throughout the API.
For example, the <tt class="docutils literal"><span class="pre">/(browse_chants)/</span></tt> URL is provided as part of the response body to a GET request
to the root URL, as specified in the <a class="reference internal" href="resource_types.html#resource-types"><em>Resource Types</em></a> section.</p>
<dl class="docutils">
<dt>TODO: ensure this is clear enough for people who aren&#8217;t used to it; this section has to answer the</dt>
<dd>question &#8220;how do I know where to find the URL for a thing?&#8221;</dd>
</dl>
</div>
<div class="section" id="development-plan">
<h3>Development Plan<a class="headerlink" href="#development-plan" title="Permalink to this headline">¶</a></h3>
<p>The first &#8220;full&#8221; release of the Cantus API, version 1.0, will be primarily based on HTTP, and will
allow read-only access to resources. The second &#8220;full&#8221; release will add read-only WebDAV features;
the third will amend this with creation and editing capabilities. If we can add WebDAV without
breaking backward compatibility, these releases will be versions 1.1 and 1.2, respectively; otherwise
2.0 and 2.1.</p>
</div>
<div class="section" id="relationship-to-existing-standards">
<h3>Relationship to Existing Standards<a class="headerlink" href="#relationship-to-existing-standards" title="Permalink to this headline">¶</a></h3>
<p>The Cantus API implements parts of the HTTP/1.1bis standard (IETF RFCs
<a class="reference external" href="https://tools.ietf.org/html/rfc7230">7230</a>, <a class="reference external" href="https://tools.ietf.org/html/rfc7231">7231</a>,
<a class="reference external" href="https://tools.ietf.org/html/rfc7232">7232</a>, <a class="reference external" href="https://tools.ietf.org/html/rfc7234">7234</a>, and
<a class="reference external" href="https://tools.ietf.org/html/rfc7237">7237</a>). In the future, the API will also implement parts of
<a class="reference external" href="https://tools.ietf.org/html/rfc">RFC 4918</a> and <a class="reference external" href="http://tools.ietf.org/html/rfc5323">5323</a>
standards for WebDAV, plus <a class="reference external" href="http://tools.ietf.org/html/rfc7235">RFC 7235</a> and
<a class="reference external" href="http://tools.ietf.org/html/rfc7236">7236</a> for user authentication.</p>
<p>This document supplements the IETF memoranda to describe what functionality is to be implemented in
Cantus software, and what behaviour to expect. In particular, the Cantus API defines
application-specific <a class="reference internal" href="http_headers.html#cantus-headers"><em>headers</em></a>, <a class="reference internal" href="response_bodies.html#response-bodies"><em>content formatting</em></a>,
and a <a class="reference internal" href="searching.html#searching"><em>search specification</em></a>.</p>
<p>Keywords indicating technical requirements are used as per <a class="reference external" href="https://tools.ietf.org/html/rfc2119">RFC 2119</a>.</p>
</div>
</div>
<div class="section" id="high-level-overview-and-examples">
<h2>High-Level Overview and Examples<a class="headerlink" href="#high-level-overview-and-examples" title="Permalink to this headline">¶</a></h2>
<p>At a high level, knowing how to format a request is primarily an issue of choosing the right URL
path, the right HTTP method, and the right HTTP headers. Parsing the response is about knowing the
expected members in the JSON-formatted response body.</p>
<p>Beacuse this API is designed with the &#8220;REST&#8221; principles in mind, every session of interaction begins
with a <tt class="docutils literal"><span class="pre">GET</span></tt> request to the root URL, written in this documentation as <tt class="docutils literal"><span class="pre">/</span></tt>. The response body
indicates the URL path to use in constructing URLs of various resource types. An abbreviated sample
interaction go like this.</p>
<p>Request:</p>
<div class="highlight-http"><div class="highlight"><pre><span class="nf">GET</span> <span class="nn">/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</pre></div>
</div>
<p>Response:</p>
<div class="highlight-http"><div class="highlight"><pre><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>

<span class="p">{</span>
    <span class="nt">&quot;resources&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;browse_sources&quot;</span><span class="p">:</span> <span class="s2">&quot;/sources/{id}/&quot;</span><span class="p">,</span>
        <span class="nt">&quot;browse_feasts&quot;</span><span class="p">:</span> <span class="s2">&quot;/feasts/{id}/&quot;</span><span class="p">,</span>
        <span class="nt">&quot;browse_chants&quot;</span><span class="p">:</span> <span class="s2">&quot;/chants/{id}/&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>From which you have learned the means by which to make the URIs to sources, feasts, and chants.
Whenever possible, metadata about the results is held in the HTTP headers, since this allows clients
to use easier formatting-for-display algorithms, and also to make use of the <tt class="docutils literal"><span class="pre">HEAD</span></tt> HTTP method
in some situations.</p>
<p>TODO: rewrite the following example so that it shouldn&#8217;t use SEARCH
TODO: first consider whether it&#8217;s a useful example at all, or you&#8217;re just convincing yourself</p>
<p>In this example request, the client requests the HTTP headers corresponding to a search query for
the &#8220;Chant&#8221; resources that contain &#8220;dixit dominus&#8221;:</p>
<div class="highlight-http"><div class="highlight"><pre><span class="nf">HEAD</span> <span class="nn">/chants/?q=&quot;dixit_dominus&quot;</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</pre></div>
</div>
<p>Consider the following response:</p>
<div class="highlight-http"><div class="highlight"><pre><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">X-SearchResults-Total</span><span class="o">:</span> <span class="l">4206</span>
<span class="na">X-SearchResults-Paginated</span><span class="o">:</span> <span class="l">true</span>
<span class="na">X-SearchResults-Page</span><span class="o">:</span> <span class="l">1</span>
<span class="na">X-SearchResults-ResultFrom</span><span class="o">:</span> <span class="l">1</span>
<span class="na">X-SearchResults-ResultTo</span><span class="o">:</span> <span class="l">10</span>
<span class="na">X-Cantus-Fields</span><span class="o">:</span> <span class="l">cantus_id incipit source folio genre feast mode siglum</span>
</pre></div>
</div>
<p>With this header information the client can make an informed decision about how to proceed.
Considering the number of results, the client may decide to automatically help the user get a
high-level view of the results. The following <tt class="docutils literal"><span class="pre">GET</span></tt> request with the same query asks for 100
results per page, and to receive only the &#8220;cantus_id,&#8221; &#8220;incipit,&#8221; and &#8220;source&#8221; fields for each
result, to avoid being overloaded with unnecessary data:</p>
<div class="highlight-http"><div class="highlight"><pre>GET /chants/?q=&quot;dixit_dominus&quot;
X-SearchResults-Paginated: true
X-SearchResults-PerPage: 100
X-Cantus-Fields: cantus_id incipit source
</pre></div>
</div>
</div>
<div class="section" id="api-versions-and-version-numbers">
<span id="version-numbers"></span><h2>API Versions and Version Numbers<a class="headerlink" href="#api-versions-and-version-numbers" title="Permalink to this headline">¶</a></h2>
<p>To help ensure easier interoperability and compatibility of clients and servers, the Cantus API will
use &#8220;semantic versioning.&#8221; This results in three-part version numbers separated by a period, like
<tt class="docutils literal"><span class="pre">1.0.0</span></tt> and <tt class="docutils literal"><span class="pre">4.6.3</span></tt>, though note that the periods are not decimals, so numbers like <tt class="docutils literal"><span class="pre">4.14.4</span></tt>
are possible.</p>
<ul class="simple">
<li>The leftmost number is the &#8220;major version,&#8221; and it must be incremented whenever a
backward-incompatible change is introduced, which should be rarely. Thus clients and servers
that implemenet different major versions are simply incompatible.</li>
<li>The middle number is the &#8220;minor version,&#8221; and it must be incremented whenever a new feature is
introduced. Thus clients and servers that implement different minor versions are compatible if
only using the features of the lower minor version.</li>
<li>The rightmost number is the &#8220;point release,&#8221; and it must be incremented whenever an error is fixed
(since this API is not software and cannot technically fail to implement itself, this will mostly
consist of clarifications and spelling or grammatical corrections).</li>
</ul>
<p>Note that this applies <em>after</em> the 1.0.0 version. 0.x.x versions are intended for API
development, so arbitrary changes may happen arbitrarily.</p>
</div>
</div>
<div class="section" id="detailed-table-of-contents">
<h1>Detailed Table of Contents<a class="headerlink" href="#detailed-table-of-contents" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="resource_types.html">Resource Types</a><ul>
<li class="toctree-l2"><a class="reference internal" href="resource_types.html#about-the-id-field">About the &#8220;id&#8221; Field</a></li>
<li class="toctree-l2"><a class="reference internal" href="resource_types.html#simple-record-types">Simple Record Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="resource_types.html#complex-record-types">Complex Record Types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="http_methods.html">HTTP Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="http_methods.html#options">OPTIONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="http_methods.html#get">GET</a></li>
<li class="toctree-l2"><a class="reference internal" href="http_methods.html#head">HEAD</a></li>
<li class="toctree-l2"><a class="reference internal" href="http_methods.html#search">SEARCH</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="http_headers.html">HTTP Headers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="http_headers.html#permanent-headers">Permanent Headers</a></li>
<li class="toctree-l2"><a class="reference internal" href="http_headers.html#cantus-specific-extension-headers">Cantus-Specific Extension Headers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="response_bodies.html">Request and Response Bodies</a><ul>
<li class="toctree-l2"><a class="reference internal" href="response_bodies.html#request-bodies">Request Bodies</a></li>
<li class="toctree-l2"><a class="reference internal" href="response_bodies.html#response-bodies">Response Bodies</a></li>
<li class="toctree-l2"><a class="reference internal" href="response_bodies.html#response-bodies-to-searches">Response Bodies to Searches</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="searching.html">How to Search</a><ul>
<li class="toctree-l2"><a class="reference internal" href="searching.html#search-request">Search Request</a></li>
<li class="toctree-l2"><a class="reference internal" href="searching.html#cantus-query-grammar">&#8220;cantus&#8221; Query Grammar</a></li>
<li class="toctree-l2"><a class="reference internal" href="searching.html#search-result">Search Result</a></li>
<li class="toctree-l2"><a class="reference internal" href="searching.html#resource-specific-information">Resource-Specific Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="searching.html#unsearchable-resource-types">Unsearchable Resource Types</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="multiserver.html">Multi-Server Interoperabilty</a><ul>
<li class="toctree-l2"><a class="reference internal" href="multiserver.html#with-cantus-servers">With Cantus Servers</a></li>
<li class="toctree-l2"><a class="reference internal" href="multiserver.html#with-non-cantus-servers">With Non-Cantus Servers</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><em>Index</em></a></li>
<li><a class="reference internal" href="py-modindex.html"><em>Module Index</em></a></li>
<li><a class="reference internal" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul>
<li class="toctree-l1"><a class="reference internal" href="resource_types.html">Resource Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="http_methods.html">HTTP Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="http_headers.html">HTTP Headers</a></li>
<li class="toctree-l1"><a class="reference internal" href="response_bodies.html">Request and Response Bodies</a></li>
<li class="toctree-l1"><a class="reference internal" href="searching.html">How to Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiserver.html">Multi-Server Interoperabilty</a></li>
</ul>

          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="search.html" method="get">
            <input type="text" name="q" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="resource_types.html" title="Resource Types"
             >next</a> |
          <a href="http-routingtable.html" title="HTTP Routing Table"
             >routing table</a> |
          <a href="genindex.html" title="General Index"
             >index</a>
            <br/>
            <a href="_sources/index.txt"
               rel="nofollow">Show Source</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2015, Christopher Antila.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>